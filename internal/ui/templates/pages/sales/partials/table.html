{{ define "sales-table" }}
<div x-show="loadingTable" class="center-align table-loading">
    <div class="preloader-wrapper small active">
        <div class="spinner-layer spinner-teal-only">
            <div class="circle-clipper left">
                <div class="circle"></div>
            </div>
            <div class="gap-patch">
                <div class="circle"></div>
            </div>
            <div class="circle-clipper right">
                <div class="circle"></div>
            </div>
        </div>
    </div>
</div>

<template x-if="!loadingTable && sales.length === 0">
    <div class="card-panel grey lighten-4 center-align">
        <p class="grey-text text-darken-1">Nenhuma venda registrada.</p>
    </div>
</template>

<template x-if="!loadingTable && sales.length > 0">
    <div>
        <table class="striped highlight responsive-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Origem</th>
                    <th>Pagamento</th>
                    <th>Itens</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="sale in sales" :key="sale.id">
                    <tr>
                        <td x-text="formatDate(sale.created_at)"></td>
                        <td x-text="sale.source"></td>
                        <td x-text="sale.payment_method"></td>
                        <td>
                            <template x-for="item in (sale.items || [])" :key="item.id">
                                <div>
                                    <span x-text="item.product_name + ' x' + item.quantity"></span>
                                    <template x-if="item.is_gift">
                                        <span class="badge green white-text"
                                            style="border-radius:4px;padding:0 6px;">brinde</span>
                                    </template>
                                    <template x-if="!item.is_gift && !sale.self_consumption">
                                        <span class="grey-text"
                                            x-text="'(' + formatMoney(item.unit_price) + ')'"></span>
                                    </template>
                                    <template x-if="!item.is_gift && sale.self_consumption">
                                        <span class="badge orange white-text"
                                            style="border-radius:4px;padding:0 6px;">autoconsumo</span>
                                    </template>
                                </div>
                            </template>
                        </td>
                        <td x-text="formatMoney(sale.total)"></td>
                    </tr>
                </template>
            </tbody>
        </table>

        <div class="center-align pagination-wrapper" x-show="totalPages > 1">
            <ul class="pagination">
                <li :class="page <= 1 ? 'disabled' : 'waves-effect'">
                    <a href="#!" @click.prevent="goToPage(page - 1)">
                        <i class="material-icons">chevron_left</i>
                    </a>
                </li>
                <template x-for="p in paginationRange()" :key="p">
                    <li :class="p === page ? 'active teal' : 'waves-effect'">
                        <a href="#!" @click.prevent="goToPage(p)" x-text="p"></a>
                    </li>
                </template>
                <li :class="page >= totalPages ? 'disabled' : 'waves-effect'">
                    <a href="#!" @click.prevent="goToPage(page + 1)">
                        <i class="material-icons">chevron_right</i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</template>
{{ end }}